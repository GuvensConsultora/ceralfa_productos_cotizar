<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ==================== LIST VIEW ==================== -->
    <!-- Por qué: vista propia que reemplaza la de Studio.
         Evita depender de herencia sobre vistas Studio que no matchean xpath.
         Incluye <header> con botón "Cotizar" visible al seleccionar registros. -->
    <record id="x_productos_cotizar_list_view" model="ir.ui.view">
        <field name="name">x_productos_a_cotizar.list.ceralfa</field>
        <field name="model">x_productos_a_cotizar</field>
        <field name="priority">1</field>
        <field name="arch" type="xml">
            <list string="Productos a Cotizar" multi_edit="1">
                <header>
                    <button name="action_cotizar" type="object"
                            string="Cotizar" class="btn-primary"/>
                </header>
                <field name="x_studio_date" string="Fecha"/>
                <field name="x_studio_cliente" string="Cliente"/>
                <field name="x_studio_date_start" string="Periodo del proceso"/>
                <field name="x_studio_date_stop" string="Fecha de finalización"/>
                <field name="x_studio_producto" string="Producto"/>
                <field name="x_studio_categoria" string="Categoría"/>
                <field name="x_studio_cantidad" string="Cantidad"/>
                <field name="x_studio_divisa_en_compras" string="Divisa Compras"/>
                <field name="x_studio_valor_cpra" string="Valor Compra Inicial"/>
                <field name="x_studio_currency_id" string="Div Vtas"/>
                <field name="x_studio_margen" string="Margen"/>
                <field name="x_studio_val_vtas_calc" string="Val Vtas Calc."/>
                <field name="x_studio_presupuesto_de_vtas" string="Ppto Vtas"/>
                <field name="x_studio_val_cpra_final" string="Valor Compra Final"/>
                <field name="x_studio_ppto_comp" string="Presup. Compra"/>
                <field name="x_studio_stage_id" string="Etapa" widget="badge"/>
                <field name="x_studio_kanban_state" string="Estado Fact Vta"/>
                <field name="x_studio_compaia" string="Compañía"/>
                <field name="x_color" string="Color" optional="hide"/>
            </list>
        </field>
    </record>

    <!-- ==================== ACTION ==================== -->
    <record id="action_x_productos_cotizar" model="ir.actions.act_window">
        <field name="name">Productos a Cotizar</field>
        <field name="res_model">x_productos_a_cotizar</field>
        <field name="view_mode">list,form,kanban</field>
        <field name="view_id" ref="x_productos_cotizar_list_view"/>
    </record>

    <!-- ==================== MENÚ ==================== -->
    <!-- Por qué: reemplaza el menú Studio apuntando a nuestra acción
         con la vista lista nueva que tiene el botón "Cotizar". -->
    <menuitem id="menu_x_productos_cotizar"
        name="Productos a Cotizar"
        action="action_x_productos_cotizar"
        parent="purchase.menu_procurement_management"
        sequence="10"/>

</odoo>
